(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5542:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return C}});var r=t(9008),a=t(4476),i=t.n(a),s=t(6311),c=t(266),o=t(809),u=t.n(o),h=t(7294),p=t(5817),l=t(8736);function f(e){return d.apply(this,arguments)}function d(){return(d=(0,c.Z)(u().mark((function e(n){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.Z.read(n).then((function(e){var n,t,r,a;return e.bitmap.width<e.bitmap.height?(n=256,t=256*e.bitmap.height/e.bitmap.width):(t=256,n=256*e.bitmap.width/e.bitmap.height),n<t?(r=0,a=t/2-128):t<n?(a=0,r=n/2-128):(r=0,a=0),e.resize(n,t).crop(r,a,256,256)}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,3,256,256],t=e.bitmap.data,r=new Array(new Array,new Array,new Array),a=(0,s.Z)(r,3),i=a[0],c=a[1],o=a[2],u=0;u<t.length;u+=4)i.push(t[u]),c.push(t[u+1]),o.push(t[u+2]);var h,p=i.concat(c).concat(o),f=p.length,d=new Float32Array(n[1]*n[2]*n[3]);for(h=0;h<f;h++)d[h]=p[h]/255*2-1;var m=new l.Tensor("float32",d,n);return m}function _(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,r=new Uint8ClampedArray(n*t*4),a=0;a<n*t;++a)r[4*a]=255*(Number(e.data[a])/2+.5),r[4*a+1]=255*(Number(e.data[n*t+a])/2+.5),r[4*a+2]=255*(Number(e.data[2*n*t+a])/2+.5),r[4*a+3]=255;return r}var x=t(5108);function v(e){return w.apply(this,arguments)}function w(){return(w=(0,c.Z)(u().mark((function e(n){var t,r,a,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.InferenceSession.create("./_next/static/chunks/pages/generator.onnx",{executionProviders:["wasm"],graphOptimizationLevel:"all"});case 2:return t=e.sent,x.log("Inference session created"),e.next=6,g(t,n);case 6:return r=e.sent,a=(0,s.Z)(r,2),i=a[0],c=a[1],e.abrupt("return",[i,c]);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,n){return b.apply(this,arguments)}function b(){return(b=(0,c.Z)(u().mark((function e(n,t){var r,a,i,s,c,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Date,(a={})[n.inputNames[0]]=t,e.next=5,n.run(a);case 5:return i=e.sent,s=new Date,c=(s.getTime()-r.getTime())/1e3,o=i[n.outputNames[0]],e.abrupt("return",[o,c]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return N.apply(this,arguments)}function N(){return(N=(0,c.Z)(u().mark((function e(n){var t,r,a,i,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m(n),e.next=3,v(t);case 3:return r=e.sent,a=(0,s.Z)(r,2),i=a[0],c=a[1],e.abrupt("return",[i,c]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=t(5893),k=function(e){var n=(0,h.useRef)(null),t=(0,h.useRef)(null),r=(0,h.useRef)(null),a=(0,h.useRef)(null),o=(0,h.useState)(""),p=o[0],l=o[1],d=(0,h.useState)(""),m=d[0],x=d[1],v=function(n,t){var r=t.getContext("2d"),a=r.createImageData(e.width,e.height);a.data.set(n),r.putImageData(a,0,0);t.toDataURL()},w=function(){var t=(0,c.Z)(u().mark((function t(){var i,c,o,h,p;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f(n.current.value);case 2:return(i=t.sent).bitmap.data=i.bitmap.data.slice(0,e.width*e.height*4),v(Uint8ClampedArray.from(i.bitmap.data),r.current),t.next=7,j(i);case 7:c=t.sent,o=(0,s.Z)(c,2),h=o[0],p=o[1],v(_(h),a.current),l(""),x("Inference time: ".concat(p," seconds"));case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("input",{className:i().grid,type:"file",ref:t,onChange:function(e){var t=(window.webkitURL||window.URL).createObjectURL(e.target.files[0]);n.current.value=t}}),(0,y.jsxs)("div",{className:i().grid,children:[(0,y.jsx)("label",{children:"URL: "}),(0,y.jsx)("input",{type:"text",ref:n,className:i().textInput,onChange:function(e){t.current.value=""}})]}),(0,y.jsx)("button",{className:i().grid,onClick:function(){l("Inferencing..."),x(""),w()},children:"Run inference"}),(0,y.jsx)("br",{}),(0,y.jsxs)("div",{className:i().canvasContainer,children:[(0,y.jsx)("canvas",{className:i().cv,ref:r,width:e.width,height:e.height}),(0,y.jsx)("canvas",{className:i().cv,ref:a,width:e.width,height:e.height})]}),(0,y.jsx)("span",{children:p}),(0,y.jsx)("span",{children:m})]})},C=function(){return(0,y.jsxs)("div",{className:i().container,children:[(0,y.jsxs)(r.default,{children:[(0,y.jsx)("title",{children:"photo2levitan web demo"}),(0,y.jsx)("meta",{name:"description",content:"Generated by create next app"}),(0,y.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,y.jsxs)("main",{className:i().main,children:[(0,y.jsx)("h1",{className:i().title,children:"photo2levitan web demo"}),(0,y.jsx)(k,{width:256,height:256}),(0,y.jsx)("div",{id:"result",className:"mt-3"})]}),(0,y.jsx)("footer",{className:i().footer,children:(0,y.jsx)("a",{href:"https://onnxruntime.ai/docs",target:"_blank",rel:"noopener noreferrer"})})]})}},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5542)}])},4476:function(e){e.exports={container:"Home_container__1EcsU",main:"Home_main__1x8gC",footer:"Home_footer__1WdhD",title:"Home_title__3DjR7",description:"Home_description__17Z4F",code:"Home_code__axx2Y",grid:"Home_grid__2Ei2F",card:"Home_card__2SdtB",logo:"Home_logo__1YbrH",canvasContainer:"Home_canvasContainer__1d1ha",cv:"Home_cv__1qC2K",textInput:"Home_textInput__1P_mE"}},2987:function(){},8104:function(){},3731:function(){},2361:function(){},4616:function(){}},function(e){e.O(0,[770,401,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);