(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5542:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var r=n(9008),a=n(4476),i=n.n(a),c=n(6311),s=n(266),u=n(809),o=n.n(u),h=n(7294),l=n(5817),d=n(8736);function p(e){return f.apply(this,arguments)}function f(){return(f=(0,s.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.Z.read(t).then((function(e){var t,n,r,a;return e.bitmap.width<e.bitmap.height?(t=256,n=256*e.bitmap.height/e.bitmap.width):(n=256,t=256*e.bitmap.width/e.bitmap.height),t<n?(r=0,a=n/2-128):n<t?(a=0,r=t/2-128):(r=0,a=0),e.resize(t,n).crop(r,a,256,256)}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,3,256,256],n=e.bitmap.data,r=new Array(new Array,new Array,new Array),a=(0,c.Z)(r,3),i=a[0],s=a[1],u=a[2],o=0;o<n.length;o+=4)i.push(n[o]),s.push(n[o+1]),u.push(n[o+2]);var h,l=i.concat(s).concat(u),p=l.length,f=new Float32Array(t[1]*t[2]*t[3]);for(h=0;h<p;h++)f[h]=l[h]/255*2-1;var m=new d.Tensor("float32",f,t);return m}function _(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,r=new Uint8ClampedArray(t*n*4),a=0;a<t*n;++a)r[4*a]=255*(Number(e.data[a])/2+.5),r[4*a+1]=255*(Number(e.data[t*n+a])/2+.5),r[4*a+2]=255*(Number(e.data[2*t*n+a])/2+.5),r[4*a+3]=255;return r}var v=n(5108);function x(e){return w.apply(this,arguments)}function w(){return(w=(0,s.Z)(o().mark((function e(t){var n,r,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.InferenceSession.create("./_next/static/chunks/pages/generator.onnx",{executionProviders:["wasm"],graphOptimizationLevel:"all"});case 2:return n=e.sent,v.log("Inference session created"),e.next=6,g(n,t);case 6:return r=e.sent,a=(0,c.Z)(r,2),i=a[0],s=a[1],e.abrupt("return",[i,s]);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){return b.apply(this,arguments)}function b(){return(b=(0,s.Z)(o().mark((function e(t,n){var r,a,i,c,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Date,(a={})[t.inputNames[0]]=n,e.next=5,t.run(a);case 5:return i=e.sent,c=new Date,s=(c.getTime()-r.getTime())/1e3,u=i[t.outputNames[0]],e.abrupt("return",[u,s]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return N.apply(this,arguments)}function N(){return(N=(0,s.Z)(o().mark((function e(t){var n,r,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m(t),e.next=3,x(n);case 3:return r=e.sent,a=(0,c.Z)(r,2),i=a[0],s=a[1],e.abrupt("return",[i,s]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=n(5893),C=function(e){var t=(0,h.useRef)(null),n=(0,h.useRef)(null),r=(0,h.useRef)(null),a=(0,h.useRef)(null),u=(0,h.useState)(""),l=u[0],d=u[1],f=function(t,n){var r=n.getContext("2d"),a=r.createImageData(e.width,e.height);a.data.set(t),r.putImageData(a,0,0);n.toDataURL()},m=function(){var n=(0,s.Z)(o().mark((function n(){var i,s,u,h,l;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p(t.current.value);case 2:return(i=n.sent).bitmap.data=i.bitmap.data.slice(0,e.width*e.height*4),f(Uint8ClampedArray.from(i.bitmap.data),r.current),n.next=7,j(i);case 7:s=n.sent,u=(0,c.Z)(s,2),h=u[0],l=u[1],f(_(h),a.current),d("Inference time: ".concat(l," seconds"));case 13:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("input",{className:i().grid,type:"file",ref:n,onChange:function(e){var n=(window.webkitURL||window.URL).createObjectURL(e.target.files[0]);t.current.value=n}}),(0,y.jsxs)("div",{className:i().grid,children:[(0,y.jsx)("label",{children:"URL: "}),(0,y.jsx)("input",{type:"text",ref:t,className:i().textInput,onChange:function(e){n.current.value=""}})]}),(0,y.jsx)("button",{className:i().grid,onClick:function(){d("Inferencing..."),r.current.getContext("2d").clearRect(0,0,e.width,e.height),a.current.getContext("2d").clearRect(0,0,e.width,e.height),m()},children:"Run inference"}),(0,y.jsx)("br",{}),(0,y.jsxs)("div",{className:i().canvasContainer,children:[(0,y.jsx)("canvas",{className:i().cv,ref:r,width:e.width,height:e.height}),(0,y.jsx)("canvas",{className:i().cv,ref:a,width:e.width,height:e.height})]}),(0,y.jsx)("span",{children:l})]})},k=function(){return(0,y.jsxs)("div",{className:i().container,children:[(0,y.jsx)(r.default,{children:(0,y.jsx)("title",{children:"photo2levitan web demo"})}),(0,y.jsxs)("main",{className:i().main,children:[(0,y.jsx)("h1",{className:i().title,children:"photo2levitan web demo"}),(0,y.jsxs)("span",{className:i().grid,children:["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438\u043b\u0438 \u0432\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u043d\u0435\u0433\u043e. \u0422\u0430\u043a\u0436\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d\xa0",(0,y.jsx)("a",{href:"https://t.me/photo2levitan_bot",target:"_blank",children:"\u0422\u0435\u043b\u0435\u0433\u0440\u0430\u043c \u0431\u043e\u0442"})]}),(0,y.jsx)(C,{width:256,height:256}),(0,y.jsx)("div",{id:"result",className:"mt-3"})]})]})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5542)}])},4476:function(e){e.exports={container:"Home_container__1EcsU",main:"Home_main__1x8gC",footer:"Home_footer__1WdhD",title:"Home_title__3DjR7",description:"Home_description__17Z4F",code:"Home_code__axx2Y",grid:"Home_grid__2Ei2F",card:"Home_card__2SdtB",logo:"Home_logo__1YbrH",canvasContainer:"Home_canvasContainer__1d1ha",cv:"Home_cv__1qC2K",textInput:"Home_textInput__1P_mE"}},2987:function(){},8104:function(){},3731:function(){},2361:function(){},4616:function(){}},function(e){e.O(0,[770,401,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);